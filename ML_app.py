import streamlit as st
import pandas as pd
import sklearn
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.model_selection import train_test_split
from sklearn.svm import SVC
from sklearn.metrics import f1_score
df = pd.read_csv('twitter_training.csv', index_col=0)
df = sklearn.utils.shuffle(df)
df = df.head(2500)
y_values = {"Positive": 1, "Negative": 2, "Neutral": 3, "Irrelevant": 0}
df.rename(columns={"Positive": "Results", "im getting on borderlands,": "Words"}, inplace=True)
df["Results"] = df["Results"].map(y_values)
df["Words"] = df["Words"].astype(str)
cls = TfidfVectorizer()
X = cls.fit_transform(df["Words"].values).toarray()
y = df["Results"]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1)
support_vector = SVC(kernel='linear', C=3)
Value = support_vector.fit(X_train, y_train)
value = ["this game is decent"]
result = cls.transform(value)
pred = support_vector.predict(result.toarray())
for cval,fval in y_values.items():
    if pred[0] == fval:
        print(cval)

print(f1_score(y_test, support_vector.predict(X_test), average=None))


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































